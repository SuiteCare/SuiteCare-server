<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.suitecare.suitecare.api.patient.mapper.PatientMapper">

    <!-- 새로운 환자 등록 프론트url=(/family/addpatient) - 기본정보 -->
    <insert id="addPatient" parameterType="PatientRequestDTO" useGeneratedKeys="true" keyProperty="id">
        insert into Patient (family_id, name, gender, birthday, diagnosis_name, height, weight, create_at, update_at)
        values (#{family_id}, #{name}, #{gender}, #{birthday}, #{diagnosis_name}, #{height}, #{weight}, sysdate(), sysdate())
    </insert>

    <!-- 새로운 환자 등록 프론트url=(/family/addpatient) - 상세정보 -->
    <insert id="addPatientDetail" parameterType="PatientRequestDTO">
        insert into PatientDetail (id, consciousness_state, meal_care_state, toilet_care_state, paralysis_state, behavioral_state, is_bedsore, need_suction, need_outpatient, need_night_care, notice)
        values (#{id}, #{consciousness_state}, #{meal_care_state}, #{toilet_care_state}, #{paralysis_state}, #{behavioral_state}, #{is_bedsore}, #{need_suction}, #{need_outpatient}, #{need_night_care}, #{notice})
    </insert>

    <!-- 환자 고유 ID 검색 -->
    <select id="getPatientID" parameterType="PatientRequestDTO">
        select id from Patient
        where (family_id = #{family_id} and name = #{name} and gender = #{gender} and birthday = #{birthday} and height = #{height} and weight = #{weight})
    </select>

    <!-- family ID로 환자 목록 검색 -->
    <select id="getPatientList" parameterType="String">
        select * from Patient
        where (family_id = #{family_id})
    </select>

    <!-- 환자 고유 ID로 환자 상세정보 검색 -->
    <select id="getPatientDetail" parameterType="PatientRequestDTO">
        select * from PatientDetail
        where (id = #{id})
    </select>
</mapper>